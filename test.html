<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link type="text/css" rel="stylesheet" href="./css/main.css">
    <title>Document</title>
</head>
<body>
<script type="module">
    import * as THREE from './js/three.module.js';
    import * as CSS3DRenderer from './js/jsm/renderers/CSS3DRenderer.js';

    let renderer	= new THREE.WebGLRenderer({
        alpha	: true
    });

    renderer.setClearColor(new THREE.Color('black'), 0)
    renderer.setSize( window.innerWidth, window.innerHeight );
    document.body.appendChild( renderer.domElement );

    let onRenderFcts	= [];
    let scene	= new THREE.Scene();
    let camera	= new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.01, 1000 );
    camera.position.z = 1

    let geometry	= new THREE.TorusKnotGeometry(0.25-0.06, 0.06);
    let material	= new THREE.MeshNormalMaterial();
    let mesh	= new THREE.Mesh( geometry, material );
    mesh.position.set(+0.7,0,+0.5);
    mesh.scale.multiplyScalar(1.5);
    scene.add( mesh );

    geometry	= new THREE.TorusKnotGeometry(0.25-0.06, 0.06);
    material	= new THREE.MeshNormalMaterial();
    mesh	= new THREE.Mesh( geometry, material );
    mesh.position.set(-0.5,0,-0.5);
    mesh.scale.multiplyScalar(1.5);
    scene.add( mesh );

    let mixerContext= new THREEx.HtmlMixer.Context(renderer, scene, camera);
    mixerContext.rendererCss.setSize( window.innerWidth, window.innerHeight );

    // handle window resize for mixerContext
    window.addEventListener('resize', function(){
        mixerContext.rendererCss.setSize( window.innerWidth, window.innerHeight )
    }, false)

    // set up rendererCss
    let rendererCss		= mixerContext.rendererCss;
    // set up rendererWebgl
    let rendererWebgl	= mixerContext.rendererWebgl;

    let css3dElement		= rendererCss.domElement;
    css3dElement.style.position	= 'absolute';
    css3dElement.style.top		= '0px';
    css3dElement.style.width	= '100%';
    css3dElement.style.height	= '100%';
    document.body.appendChild( css3dElement );

    let webglCanvas			= rendererWebgl.domElement;
    webglCanvas.style.position	= 'absolute';
    webglCanvas.style.top		= '0px';
    webglCanvas.style.width		= '100%';
    webglCanvas.style.height	= '100%';
    webglCanvas.style.pointerEvents	= 'none';
    css3dElement.appendChild( webglCanvas );

    window.addEventListener('resize', function(){
        // notify the renderer of the size change
        renderer.setSize( window.innerWidth, window.innerHeight )
        // update the camera
        camera.aspect	= window.innerWidth / window.innerHeight
        camera.updateProjectionMatrix()
    }, false)

</script>

<script src="./js/threex.htmlmixer.js"></script>

</body>
</html>